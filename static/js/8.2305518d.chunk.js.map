{"version":3,"sources":["Utils/fileUpload.ts","Component/common/CodeEditor.tsx","Component/common/Form/Item/ItemTitle.tsx","Component/common/Form/Item/ItemText.tsx","Component/common/Form/Item/ItemCodeEditor.tsx","Component/common/Form/Item/ItemUpload.tsx","Component/judgeTemplate/Form/TemplateMForm.tsx","Pages/Manage/MJudgeTemplate.tsx","Component/common/Table/TableWithPagination.tsx","Component/common/Form/ModalFormUseForm.tsx"],"names":["fileUpload","files","callback","formData","FormData","num","pros","md5Set","forEach","file","push","arrayBuffer","then","value","code","md5","CApi","getFileByMD5","Promise","resolve","append","all","uploadFile","data","map","fileUploadWithoutMD5","uploadSingleFile","langMap","cpp","c","java","sql","python","CodeEditor","props","extensions","lang","height","readOnly","theme","githubLight","autoFocus","basicSetup","lineNumbers","autocompletion","syntaxHighlighting","tabSize","completionKeymap","lintKeymap","foldKeymap","searchKeymap","allowMultipleSelections","bracketMatching","onChange","withTranslation","Item","label","t","name","required","initialValue","help","addonAfter","ItemEditor","UploadFile","nameList","nm","accept","split","id","filename","downloadFilename","downloadFileSuffix","isValueEmpty","style","marginBottom","size","onClick","path","apiAddress","CLIENT_SERVER","window","open","danger","multiple","action","listType","beforeUpload","ues","showUploadList","className","InboxOutlined","rules","ItemTitle","ItemText","mode","width","ItemCodeEditor","use","withRouter","pathArray","location","pathname","type","length","colData","title","dataIndex","responsive","render","text","unix2Time","parseInt","rows","TableName","subForm","component","dataLoader","async","mApi","getOneTemplate","updateAppendProps","dataSubmitter","updateTemplate","createTemplate","marginTop","overflow","bordered","extra","columns","API","paras","MApi","pageTemplateList","rowKey","connect","state","UState","UserReducer","TState","TableReduce","roles","userInfo","tableData","dispatch","setTableInfo","setDataSource","add","total","setTotal","useState","setTableDataX","loading","setLoading","PageNow","setPageNow","PageSize","setPageSize","ck","defaultPageSize","searchText","setSearchText","tableVersion","setTableVersion","setTableData","undefined","getInfo","pageNow","pageSize","searchKey","moreProps","propsTableInfo","tableInfo","form","setFieldsValue","pn","ps","sk","fmp","getFieldsValue","APIRowsTransForm","totalNum","totalPage","useEffect","initRequestProps","useForm","onFinish","values","JSON","stringify","onReset","resetFields","tf","valuesAfter","propsTableVersion","dataSource","useList","cardProps","search","getForm","placeholder","onSearch","enterButton","useFormBtn","marginLeft","htmlType","grid","itemLayout","renderItem","pagination","page","current","hideOnSinglePage","showQuickJumper","showLessItems","showSizeChanger","pageSizeOptions","rowSelection","addTableVersion","addManageInitData","key","formMapRef","useRef","formVis","setFormVis","saveInitData","setSaveInitData","setCurrent","submitting","setSubmitting","setTimeout","formInstanceRef","formName","submitData","submit","Object","assign","res","afterSubmit","onClose","message","success","finally","validateFields","catch","error","btnProps","btnType","create","update","fork","batchUpdate","initData","hied","content","duration","paddingLeft","paddingRight","btnIcon","btnName","minWidth","destroyOnClose","visible","maskClosable","onCancel","footer","layout","initialValues","scrollToFirstError","preserve","onCurrentChange","currentPage","submitter","submitButtonProps","stepsFormRender","dom","item","index","StepForm"],"mappings":"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","file":"static/js/8.2305518d.chunk.js","sourcesContent":["import CApi from \"Utils/API/c-api\"\nimport md5 from \"js-md5\";\n\nexport const fileUpload = (files: File[], callback: any) => {\n    let formData = new FormData();\n    let num = 0\n    let pros: Promise<any>[] = []\n    let md5Set: Promise<any>[] = []\n    files.forEach((file) => {\n        md5Set.push(\n            file.arrayBuffer().then(((value) => {\n                let code = md5(value)\n                pros.push(\n                    CApi.getFileByMD5({md5: code}).then((value: any) => {\n                        if (value !== null) {\n                            callback(value)\n                            return Promise.resolve()\n                        } else {\n                            formData.append(\"files\", file);\n                            num += 1;\n                            return Promise.resolve()\n                        }\n                    })\n                )\n                return Promise.resolve()\n            }))\n        )\n    });\n\n    Promise.all(md5Set).then(() => {\n        Promise.all(pros).then(() => {\n            if (num !== 0) {\n                CApi.uploadFile(formData).then((data: any) => {\n                    data.map((value: any) => {\n                        callback(value)\n                        return undefined\n                    })\n                })\n            }\n        })\n    })\n}\n\nexport const fileUploadWithoutMD5 = (file: File, callback: any) => {\n    let formData = new FormData();\n    formData.append(\"file\", file);\n    CApi.uploadSingleFile(formData).then((data: any) => {\n        callback(data)\n        return undefined\n    })\n}","import CodeMirror from '@uiw/react-codemirror';\nimport {githubLight} from '@uiw/codemirror-theme-github';\nimport {cpp} from '@codemirror/lang-cpp';\nimport {java} from '@codemirror/lang-java';\nimport {sql} from '@codemirror/lang-sql';\nimport {python} from '@codemirror/lang-python';\n\n\ninterface ICodeEditor {\n    lang: \"c\" | \"cpp\" | \"java\" | \"sql\" | \"python\" | \"text\"\n    code?: string\n    value?: string\n    className?: string\n    onChange?: any\n    readOnly?: boolean\n\n}\n\n\nconst langMap = {\n    cpp: cpp,\n    c: cpp,\n    java: java,\n    sql: sql,\n    python: python,\n}\n\nconst CodeEditor = (props: ICodeEditor) => {\n\n    let extensions: any = []\n    if (props.lang !== \"text\") {\n        extensions = [(langMap[props.lang])()]\n    }\n\n    return (\n        <>\n            <CodeMirror\n                value={props.value}\n                height={\"400px\"}\n                readOnly={props.readOnly ?? false}\n                theme={githubLight}\n                autoFocus={true}\n                extensions={extensions}\n                basicSetup={{\n                    lineNumbers: true,\n                    autocompletion: true,\n                    syntaxHighlighting: true,\n                    tabSize: 4,\n                    completionKeymap: true,\n                    lintKeymap: true,\n                    foldKeymap: true,\n                    searchKeymap: true,\n                    allowMultipleSelections: true,\n                    bracketMatching: true\n                }}\n                // options={{\n                //     indentUnit: 4,\n                //     smartIndent: true,\n                //     lineWrapping: true,\n                //     autoRefresh: true,\n                //     electricChars: true\n                // }}\n                onChange={(value) => {\n                    props.onChange && props.onChange(value)\n                }}\n            />\n        </>\n    )\n\n}\n\nexport default CodeEditor\n","import {Form, Input} from \"antd\";\nimport React from \"react\";\nimport {withTranslation} from \"react-i18next\";\n\nconst ItemTitle = (props: any) => {\n    return (\n        <>\n            <Form.Item label={props.label ?? props.t(\"title\")} name={props.name ?? \"title\"} required={true}>\n                <Input/>\n            </Form.Item>\n        </>\n    )\n}\n\nexport default withTranslation()(ItemTitle)\n","import {Form, Input} from \"antd\";\nimport React from \"react\";\nimport {withTranslation} from \"react-i18next\";\n\nconst ItemText = (props: any) => {\n    return (\n        <>\n            <Form.Item\n                label={props.label}\n                name={props.name}\n                required={props.required ?? true}\n                initialValue={props.initialValue}\n                help={props.help}\n            >\n                <Input addonAfter={props.addonAfter}/>\n            </Form.Item>\n        </>\n    )\n}\n\nexport default withTranslation()(ItemText)","import {Form} from \"antd\";\nimport CodeEditor from \"../../CodeEditor\";\n\nconst ItemEditor = (props: any) => {\n    return (\n\n        <Form.Item label={props.label} name={props.name} {...props}>\n            <CodeEditor lang={props.lang}/>\n        </Form.Item>\n    )\n}\n\nexport default ItemEditor","import {Button, Form, Space} from \"antd\";\nimport React from \"react\";\nimport {withTranslation} from \"react-i18next\";\nimport {InboxOutlined} from \"@ant-design/icons\";\nimport Dragger from \"antd/lib/upload/Dragger\";\nimport {isValueEmpty} from \"../../../../Utils/empty\";\nimport apiAddress from \"../../../../Utils/API/apiAddress\";\nimport {fileUpload, fileUploadWithoutMD5} from \"../../../../Utils/fileUpload\";\n\ninterface ItemUploadPropsType{\n    label: string       // Form 标签\n    name: string        // Form 字段\n    required: boolean   // Form 必要性校验\n    accept: string      // 可接受的文件类型\n    use: \"user\" | \"admin\"       // 上传文件着\n    downloadFilename?: string    // 下载时的文件名\n    downloadFileSuffix: string  // 下载的文件后缀\n}\n\nconst ItemUpload = (props: ItemUploadPropsType & any) => {\n\n    return (\n        <>\n            <Form.Item label={props.label ?? \"上传文件\"} name={props.name} rules={[{required: props.required}]}>\n                <UploadFile {...props}/>\n            </Form.Item>\n        </>\n    )\n}\n\n\n\nconst UploadFile = (props: any) => {\n\n    const {value, onChange} = props\n\n    let nameList: string[] = []\n    for (let nm of props.accept.split(\",\")) {\n        nameList.push(\"*\" + nm)\n    }\n\n    const callback = (value: any) => {\n        onChange(value.id)\n    }\n    const upload = (file: any) => {\n        if (props.ues === \"user\")\n            fileUploadWithoutMD5(file, callback)\n        else fileUpload([file], callback)\n    }\n\n    const filename = (props.downloadFilename ?? value) + props.downloadFileSuffix;\n\n    return (\n        <>\n            {!isValueEmpty(value) && (\n                <div style={{marginBottom: 24}}>\n                    <div> 已有文件： </div>\n                    <Space>\n                        {filename}\n                        <Button size={\"small\"} onClick={() => {\n                            const path = apiAddress().CLIENT_SERVER + \"/api/filesys/download/\" + value + \"/\" + filename\n                            window.open(path)\n                        }}>下载</Button>\n                        <Button danger size={\"small\"} onClick={() => {\n                            onChange(null)\n                        }}>删除</Button>\n                    </Space>\n\n                </div>\n            )}\n            <Dragger\n                multiple={false}\n                accept={props.accept}\n                action=\"\"\n                listType=\"text\"\n                beforeUpload={upload}\n                showUploadList={false}\n            >\n                <p className=\"ant-upload-drag-icon\">\n                    <InboxOutlined/>\n                </p>\n                <p className=\"ant-upload-text\">单击或拖动文件到此区域进行上传</p>\n                <p className=\"ant-upload-hint\">\n                    请上传一个 {nameList} 文件\n                </p>\n            </Dragger>\n        </>\n    )\n}\n\nexport default withTranslation()(ItemUpload)\n","import {withTranslation} from \"react-i18next\";\nimport ItemTitle from \"../../common/Form/Item/ItemTitle\";\nimport ItemText from \"../../common/Form/Item/ItemText\";\nimport {Form, Select} from \"antd\";\nimport ItemCodeEditor from \"../../common/Form/Item/ItemCodeEditor\";\nimport ItemUpload from \"../../common/Form/Item/ItemUpload\";\n\nconst TemplateMForm = (props: any) => {\n    return (\n        <>\n            <ItemTitle/>\n            <ItemText label={\"备注\"} name={\"comment\"} required={false}/>\n            <Form.Item label={\"文件后缀\"} name={\"acceptFileExtensions\"} required>\n                <Select mode=\"tags\" style={{ width: '100%' }} />\n            </Form.Item>\n            <ItemCodeEditor\n                label={\"shell脚本\"}\n                name={\"shellScript\"}\n                lang={\"cpp\"}\n                className={\"JudgeTemplateCodeEditor\"}\n                rules={[{required: true}]}\n            />\n            <ItemUpload\n                label={\"ZIP资源文件\"}\n                name={\"zipFileId\"}\n                required={false}\n                accept={\".zip\"}\n                use={\"admin\"}\n                downloadFileSuffix={\".zip\"}\n            />\n\n        </>\n    )\n}\n\nexport default withTranslation()(TemplateMForm)\n","import React from \"react\";\nimport {Card, Space} from \"antd\";\nimport MApi from \"../../Utils/API/m-api\";\nimport mApi from \"../../Utils/API/m-api\";\nimport {withTranslation} from \"react-i18next\";\nimport {withRouter} from \"react-router-dom\";\nimport TableWithPagination from \"../../Component/common/Table/TableWithPagination\";\nimport {unix2Time} from \"../../Utils/Time\";\nimport ModalFormUseForm from \"../../Component/common/Form/ModalFormUseForm\";\nimport TemplateMForm from \"../../Component/judgeTemplate/Form/TemplateMForm\";\n\nconst MJudgeTemplate = (props: any) => {\n    const pathArray = props.location.pathname.split(\"/\")\n    const type = pathArray[pathArray.length - 1]\n\n    let colData: any[] = [\n        {\n            title: \"ID\",\n            dataIndex: \"id\",\n            width: 50,\n            responsive: [\"lg\", \"sm\", \"xs\"]\n        },\n        {\n            title: props.t(\"Owner\"),\n            dataIndex: \"username\",\n            width: \"auto\",\n            responsive: [\"lg\"],\n        },\n        {\n            title: props.t(\"title\"),\n            dataIndex: \"title\",\n            width: \"auto\",\n            responsive: [\"lg\", \"sm\"],\n        },\n        {\n            title: props.t(\"comment\"),\n            dataIndex: \"comment\",\n            width: \"auto\",\n            responsive: [\"lg\"],\n        },\n        {\n            title: props.t(\"CreateTime\"),\n            dataIndex: \"gmtCreate\",\n            width: \"auto\",\n            responsive: [\"lg\", \"sm\"],\n            render: (text: string) => {\n                return unix2Time(parseInt(text))\n            }\n        },\n        {\n            title: props.t(\"ModifiedTime\"),\n            dataIndex: \"gmtModified\",\n            width: \"auto\",\n            responsive: [\"lg\", \"sm\"],\n            render: (text: string) => {\n                return unix2Time(parseInt(text))\n            }\n        },\n        {\n            title: props.t(\"operator\"),\n            width: \"150px\",\n            render: (text: any, rows: any) => {\n                return <Space size={3}>\n                    <ModalFormUseForm\n                        TableName={`TemplateList-${type}`}\n                        width={600}\n                        title={rows.title}\n                        type={\"update\"}\n                        subForm={[\n                            {\n                                component: <TemplateMForm/>,\n                                label: \"\"\n                            },\n                        ]}\n                        dataLoader={async () => {\n                            return mApi.getOneTemplate({id: rows.id}).then((value: any) => {\n                                return Promise.resolve(value)\n                            })\n                        }}\n                        updateAppendProps={{id: rows.id}}\n                        dataSubmitter={(value: any) => {\n                            return mApi.updateTemplate({type: type === \"io\" ? 0 : 2, ...value})\n                        }}\n                    />\n                    <ModalFormUseForm\n                        TableName={`TemplateList-${type}`}\n                        width={600}\n                        title={\"新建模板(克隆自\" + rows.title + \")\"}\n                        type={\"fork\"}\n                        subForm={[\n                            {\n                                component: <TemplateMForm/>,\n                                label: \"\"\n                            },\n                        ]}\n                        dataLoader={async () => {\n                            return mApi.getOneTemplate({id: rows.id}).then((value: any) => {\n                                return Promise.resolve(value)\n                            })\n                        }}\n                        dataSubmitter={(value: any) => {\n                            return mApi.createTemplate({type: type === \"io\" ? 0 : 2, ...value})\n                        }}\n                    />\n                </Space>\n            }\n        }\n    ]\n\n    return (\n        <div style={{marginTop: -20, overflow: \"hidden\"}}>\n            <Card\n                size={\"small\"}\n                bordered={true}\n                title={type === \"io\" ? \"基础IO模板\" : \"高阶评测模板\"}\n                extra={\n                    <>\n                        <ModalFormUseForm\n                            TableName={`TemplateList-${type}`}\n                            width={600}\n                            title={\"新建模板\"}\n                            type={\"create\"}\n                            subForm={[\n                                {\n                                    component: <TemplateMForm/>,\n                                    label: \"\"\n                                },\n                            ]}\n                            dataSubmitter={(value: any) => {\n                                return mApi.createTemplate({type: type === \"io\" ? 0 : 2, ...value})\n                            }}\n                        />\n                    </>\n                }\n            >\n                <TableWithPagination\n                    name={`TemplateList-${type}`}\n                    columns={colData}\n                    API={(paras: any) => {\n                        return MApi.pageTemplateList({...paras, type: type === \"io\" ? 0 : 2})\n                    }}\n                    size={\"small\"}\n                    rowKey={\"id\"}\n                />\n            </Card>\n        </div>\n    )\n\n}\n\nexport default withTranslation()(withRouter(MJudgeTemplate))\n","import {Button, Card, Form, List, Space, Table} from \"antd\";\nimport React, {Dispatch, useEffect, useState} from \"react\";\nimport {defaultPageSize} from \"../../../Config/constValue\";\nimport {UserState} from \"../../../Type/Iuser\";\nimport {connect} from \"react-redux\";\nimport {withTranslation} from \"react-i18next\";\nimport {withRouter} from \"react-router\";\nimport Search from \"antd/es/input/Search\";\nimport {TableState} from \"../../../Type/ITable\";\nimport {ck} from \"../../../Utils/empty\";\nimport {SizeType} from \"antd/lib/config-provider/SizeContext\";\nimport {ColumnsType} from \"antd/lib/table/interface\";\nimport {useForm} from \"antd/es/form/Form\";\n\nexport interface TableWithPaginationProps {\n    API: any                  // 表格查询数据的接口\n    size: SizeType            // 表格的大小\n    columns: ColumnsType<any> // 表格的列\n    name: string              // 表格名称\n    APIRowsTransForm?: any    // 针对API传输的数据进行转化的函数\n    search?: boolean          // 是否开启搜索功能\n    defaultPageSize?: number  // 表格默认的页大小\n\n    // 面向 可选择的行 开放的接口\n    // setDataSource?: any       // 输出当前表格的数据\n    rowKey?: any              // 作为 key 记录的值\n    rowSelection?: any        // 可选列的相关配置\n\n}\n\nconst TableWithPagination = (props: any) => {\n    const [total, setTotal] = useState<number>(0)                   // 项的总数\n    const [tableData, setTableDataX] = useState()                            // 表格核心数据\n    const [loading, setLoading] = useState(true)                    // 表格的加载状态\n    const [PageNow, setPageNow] = useState<number>(1)               // 当前的页码数\n    const [PageSize, setPageSize] = useState<number>(ck(props.defaultPageSize, defaultPageSize))         // 当前的页大小\n    const [searchText, setSearchText] = useState<string | undefined>()        // 搜索的文本\n    const [tableVersion, setTableVersion] = useState<number>(0)     // 表格版本（控制表格刷新）\n\n    const setTableData = (data: any) => {\n        setTableDataX(data)\n        // 若有 选中行 的相关配置，传递数据进行更新\n        if (props.setDataSource !== undefined && props.name !== undefined)\n            props.setDataSource(data, props.name)\n    }\n    // 这里的所有的参数都只能增量的修改，不能删除，删除需要手动更新 redux\n    const getInfo = (pageNow?: number, pageSize?: number, searchKey?: string, moreProps?: any) => {\n        const propsTableInfo = props.tableData[props.name]?.tableInfo\n        if (propsTableInfo !== undefined) {\n            if (moreProps === undefined && propsTableInfo.moreProps !== undefined){\n                form.setFieldsValue(propsTableInfo.moreProps)\n            }\n            pageNow = pageNow ?? propsTableInfo.pageNow\n            pageSize = pageSize ?? propsTableInfo.pageSize\n            searchKey = searchKey ?? propsTableInfo.searchKey\n            moreProps = moreProps ?? propsTableInfo.moreProps\n        }\n        let pn = pageNow ?? PageNow\n        let ps = pageSize ?? PageSize\n        let sk = searchKey ?? searchText\n        let fmp = moreProps ?? form.getFieldsValue()\n        setPageNow(pn)\n        setPageSize(ps)\n        setSearchText(sk)\n        setLoading(true)\n        props.API({\n            pageNow: pn,\n            pageSize: ps,\n            searchKey: sk,\n            ...fmp\n        }).then((data: any) => {\n            // console.log(\"data\", data)\n            if (data.rows === null) data.rows = []\n            if (props.APIRowsTransForm !== undefined) {\n                setTableData(props.APIRowsTransForm(data.rows))\n            } else setTableData(data.rows)\n            if (data.totalNum !== undefined && data.totalNum !== \"0\") {\n                setTotal(data.totalNum)\n                props.name && props.setTableInfo(props.name, {\n                    total: data.totalNum,\n                    pageNow: pn,\n                    pageSize: ps,\n                    searchKey: sk,\n                    moreProps: fmp\n                })\n            } else {\n                setTotal(ps * data.totalPage);\n                props.name && props.setTableInfo(props.name, {\n                    total: ps * data.totalPage,\n                    pageNow: pn,\n                    pageSize: ps,\n                    searchKey: sk,\n                    moreProps: fmp\n                })\n            }\n            setLoading(false)\n        })\n    }\n\n    useEffect(() => {\n        form.setFieldsValue(props.initRequestProps)\n        getInfo()\n    }, [props.name])\n\n    // 带有表单的筛选\n    const [form] = useForm()\n    const onFinish = () => {\n        const values = form.getFieldsValue()\n        if (JSON.stringify(values) !== \"{}\")\n            getInfo(1, PageSize, undefined, values)\n    };\n    const onReset = () => {\n        const values = form.getFieldsValue()\n        form.resetFields();\n        const tf = props.tableData[props.name]?.tableInfo\n        props.name && props.setTableInfo(props.name, {\n            total: tf.total,\n            pageNow: tf.pageNow,\n            pageSize: tf.pageSize,\n            searchKey: tf.searchKey,\n            moreProps: undefined\n        })\n        const valuesAfter = form.getFieldsValue()\n        // 重置前后若发生改变，则重新加载表格\n        if (JSON.stringify(values) !== JSON.stringify(valuesAfter))\n            getInfo(1, PageSize, undefined, undefined)\n\n    };\n\n\n    useEffect(() => {\n        // 监听表格的版本变化，当版本变更时更新表格\n        const propsTableVersion = props.tableData[props.name]?.tableVersion\n        if (propsTableVersion !== undefined && tableVersion !== propsTableVersion) {\n            // 如果数据被外部应用更新，则用 redux 中的数据更新当前行\n            if (propsTableVersion < 0) {\n                setTableVersion(-propsTableVersion)\n                setTableDataX(props.tableData[props.name]?.dataSource)\n            } else {\n                // 否则，重新进行请求\n                setTableVersion(propsTableVersion)\n                const values = form.getFieldsValue()\n                getInfo(PageNow, PageSize, searchText, values)\n            }\n        }\n    }, [props.tableData, tableVersion])\n\n    return (\n        <>\n            {props.useList && (\n                <Card\n                    title={props.title}\n                    bordered={true}\n                    size={\"default\"}\n                    className={props.cardProps ?? \"zeroBodyPaddingLeft\"}\n                    extra={\n                        (props.search === true || props.getForm !== undefined) && (\n                            <>\n                                {props.search === true && (\n                                    <Search\n                                        key={\"search\"}\n                                        placeholder={props.t(\"searchUser\")}\n                                        onSearch={(text) => {\n                                            setSearchText(text)\n                                            setPageNow(1)\n                                            const values = form.getFieldsValue()\n                                            getInfo(1, PageSize, text, values)\n                                        }}\n                                        enterButton\n                                        style={{width: 300}}\n                                    />\n                                )}\n                                {props.getForm !== undefined && (\n                                    <Form form={form}>\n                                        {props.getForm(onFinish)}\n                                        {props.useFormBtn && (\n                                            <Space style={{marginLeft: \"30px\"}} size={20}>\n                                                <Button type=\"primary\" onClick={onFinish}>\n                                                    筛选\n                                                </Button>\n                                                <Button htmlType=\"button\" onClick={onReset}>\n                                                    重置\n                                                </Button>\n                                            </Space>\n                                        )}\n                                    </Form>\n                                )}\n                            </>\n                        )\n                    }\n                >\n                    <List\n                        grid={props.grid}\n                        itemLayout={\"vertical\"}\n                        loading={loading}\n                        size={props.size}\n                        dataSource={tableData}\n                        renderItem={props.renderItem}\n                        pagination={{\n                            onChange: (page, pageSize) => {\n                                getInfo(page, pageSize)\n                            },\n                            current: PageNow,\n                            pageSize: PageSize,\n                            total: total,\n                            size: \"small\",\n                            hideOnSinglePage: true,\n                            showQuickJumper: true,\n                            showLessItems: true,\n                            showSizeChanger: ck(props.showSizeChanger, true),\n                            pageSizeOptions: [\"5\", \"15\", \"20\", \"50\", \"80\"],\n                        }}\n                    />\n                </Card>\n            )}\n            {!props.useList && (\n                <Card\n                    bordered={false}\n                    size={\"small\"}\n                    extra={\n                        (props.search === true || props.getForm !== undefined) && (\n                            <>\n                                {props.search === true && (\n                                    <Search\n                                        key={\"search\"}\n                                        placeholder={\"搜索\"}\n                                        onSearch={(text) => {\n                                            setSearchText(text)\n                                            setPageNow(1)\n                                            getInfo(1, PageSize, text)\n                                        }}\n                                        enterButton\n                                        style={{width: 300}}\n                                    />\n                                )}\n                                {props.getForm !== undefined && (\n                                    <Form form={form}>\n                                        {props.getForm(onFinish)}\n                                        <Space style={{marginLeft: \"30px\"}} size={20}>\n                                            <Button type=\"primary\" onClick={onFinish}>\n                                                {props.t(\"filtering\")}\n                                            </Button>\n                                            <Button htmlType=\"button\" onClick={onReset}>\n                                                {props.t(\"Reset\")}\n                                            </Button>\n                                        </Space>\n                                    </Form>\n                                )}\n                            </>\n                        )\n                    }\n                >\n                    <Table\n                        rowKey={props.rowKey}\n                        loading={loading}\n                        size={props.size}\n                        columns={props.columns}\n                        rowSelection={props.rowSelection}\n                        dataSource={tableData}\n                        pagination={props.pagination ?? {\n                            onChange: (page, pageSize) => {\n                                getInfo(page, pageSize)\n                            },\n                            current: PageNow,\n                            pageSize: PageSize,\n                            total: total,\n                            hideOnSinglePage: false,\n                            showQuickJumper: true,\n                            showLessItems: true,\n                            showSizeChanger: ck(props.showSizeChanger, true),\n                            pageSizeOptions: [\"5\", \"15\", \"20\", \"50\", \"80\"],\n                        }}\n                    />\n                </Card>\n            )}\n        </>\n    )\n\n}\n\nconst mapStateToProps = (state: any) => {\n    const UState: UserState = state.UserReducer\n    const TState: TableState = state.TableReduce\n    return {\n        roles: UState.userInfo?.roles,\n        tableData: {...TState.tableData}\n    }\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch<any>) => ({\n    setTableInfo: (name: string, data: any) => dispatch({\n        type: \"setTableInfo\",\n        name: name,\n        data: data\n    }),\n    setDataSource: (data: any, name: string) =>\n        dispatch({type: \"setDataSource\", data: data, name: name, add: false})\n})\n\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(withTranslation()(\n    withRouter(TableWithPagination)\n))\n\n","import React, {Dispatch, useEffect, useRef, useState} from \"react\";\nimport {connect} from \"react-redux\";\nimport {withTranslation} from \"react-i18next\";\nimport {withRouter} from \"react-router\";\nimport {Button, Form, message, Modal} from \"antd\";\nimport {ButtonType} from \"antd/lib/button/button\";\nimport {EditOutlined, PlusOutlined} from \"@ant-design/icons\";\nimport {ck, isValueEmpty} from \"../../../Utils/empty\";\nimport {useForm} from \"antd/es/form/Form\";\nimport {ProFormInstance, StepsForm} from \"@ant-design/pro-form\";\n\ninterface subFormType {\n    component: any\n    label: string\n}\n\ninterface ModalFormProps {\n    // 表单类型\n    type: \"create\" | \"update\" | \"batchUpdate\"\n    // 初始化数据，必须包含 initData 或 dataLoader 之一\n    initData?: { [key: string]: {} }\n    dataLoader?: () => Promise<any>   // 异步数据加载\n    dataSubmitter: (data: any) => Promise<any>\n    afterSubmit?: () => any                      // 提交完成之后的回调\n    updateAppendProps?: { [key: string]: any }\n\n    title: string           // 弹窗标题\n    TableName?: string      // 若有需要更新的表格，其名称\n    className?: any          // 类名\n    subForm: subFormType[]  // 子表单信息\n    btnProps?: any\n    layout?: any,\n    onClose?: any   // 关闭时进行回调\n}\n\nconst ModalForm = (props: ModalFormProps & any) => {\n\n    const [form] = useForm()\n    const formMapRef = useRef<React.MutableRefObject<ProFormInstance<any> | undefined>[]>([]);\n    const [formVis, setFormVis] = useState<boolean>(false)\n    const [saveInitData, setSaveInitData] = useState();\n    const [current, setCurrent] = useState<number>(0)\n    const [submitting, setSubmitting] = useState<boolean>(false);\n\n    const BtnTypeMap: { [key: string]: ButtonType } = {\n        create: \"primary\",\n        update: \"link\",\n        fork: \"link\",\n        batchUpdate: \"primary\"\n    }\n\n\n    const loadData = () => {\n        if (props.type === \"update\" || props.type === \"fork\") {\n            // 若初始化信息为空，则调用数据加载器进行异步数据加载\n            if (props.initData === undefined) {\n                const hied = message.loading({\n                    content: \"加载中\",\n                    duration: 0,\n                })\n                if (props.dataLoader === undefined) {\n                    hied()\n                    message.error(\"未定义数据加载器\")\n                    return\n                }\n                props.dataLoader && props.dataLoader().then((data: any) => {\n                    // console.log(\"dataLoaderData\", data)\n                    setSaveInitData(data)\n                    // if (props.subForm.length !== 1) {\n                    // } else form.setFieldsValue(data)\n                    hied()\n                    setFormVis(true)\n                }).catch(() => {\n                    hied()\n                })\n            } else {\n                // 否则直接进行数据加载\n                // console.log(\"initData\",props.initData)\n                setSaveInitData(props.initData)\n                setFormVis(true)\n            }\n        } else if (props.type === \"create\") {\n            if (props.initData !== undefined) {\n                setSaveInitData(props.initData)\n            }\n            setFormVis(true)\n        } else {\n            setFormVis(true)\n        }\n    }\n\n    // 当表单的可见性发生改变时，维护表单信息\n    useEffect(() => {\n        // 延迟向表单注入信息\n        setTimeout(() => {\n            !isValueEmpty(formMapRef.current) && formMapRef.current.forEach((formInstanceRef) => {\n                formInstanceRef.current?.setFieldsValue(saveInitData);\n            });\n            form && form.setFieldsValue(saveInitData)\n        }, 100)\n\n        // 当表单消失时，清除相关数据\n        if (!formVis) {\n            setCurrent(0)\n            formMapRef.current.forEach((formInstanceRef) => {\n                formInstanceRef.current?.resetFields()\n            });\n            props.formName && props.addManageInitData(props.formName, undefined)\n        }\n    }, [formVis, saveInitData])\n\n    useEffect(() => {\n        props.formName && props.addManageInitData(props.formName, saveInitData)\n    }, [saveInitData])\n\n    // 提交数据\n    const submitData = (values: any) => {\n        const submit = (value: any) => {\n            // console.log(\"inner\", value)\n            setSubmitting(true);\n            // 在提交表单数据之前，追加数据\n            props.updateAppendProps && Object.assign(value, props.updateAppendProps)\n            props.dataSubmitter(value).then((res: any) => {\n                // 当数据绑定表格时，更新表格数据\n                props.TableName && props.addTableVersion(props.TableName)\n                props.afterSubmit && props.afterSubmit(res)\n                props.onClose && props.onClose()\n                setFormVis(false)\n                message.success(\"成功\")\n            }).finally(() => {\n                setSubmitting(false);\n            })\n        }\n\n        if (props.subForm.length === 1) {\n            // 只有一页的表单，需要手动进行验证\n            // console.log(form)\n            form.validateFields().then((value) => {\n                submit(value)\n            }).catch(() => {\n                message.error('表单不完整')\n            })\n        } else submit(values)\n    }\n\n    return (\n        <>\n            <Button\n                {...props.btnProps}\n                type={ck(props.btnType, BtnTypeMap[props.type])}\n                onClick={loadData}\n                style={\n                    (props.type === \"fork\" || props.type === \"update\" || props.btnType === \"link\") ? {\n                        paddingLeft: 5,\n                        paddingRight: 5\n                    } : undefined\n                }\n            >\n                {(() => {\n                    if (props.btnIcon !== false) {\n                        if (props.type === \"create\") return <PlusOutlined/>\n                        if (props.type === \"batchUpdate\") return <EditOutlined/>\n                    }\n                })()}\n                {(() => {\n                    if (props.btnName !== undefined)\n                        return props.btnName\n                    switch (props.type) {\n                        case \"create\":\n                            return props.t(\"create\")\n                        case \"update\":\n                            return props.t(\"Edit\")\n                        case \"fork\":\n                            return \"克隆\"\n                        default:\n                            return \"批量修改\"\n                    }\n                })()}\n            </Button>\n            {props.subForm.length === 1 && (\n                <Modal\n                    width={props.width}\n                    style={{minWidth: props.width}}\n                    destroyOnClose={true}\n                    title={props.title}\n                    className={props.className}\n                    visible={formVis}\n                    maskClosable={false}\n                    onCancel={() => {\n                        props.onClose && props.onClose()\n                        setFormVis(false)\n                    }}\n                    footer={[\n                        <Button type=\"primary\" key=\"submit\" onClick={submitData} loading={submitting}>\n                            {props.t(\"Submit\")}\n                        </Button>\n                    ]}\n                >\n                    <Form\n                        form={form}\n                        layout={props.layout ?? \"vertical\"}\n                        initialValues={props.initData}\n                        scrollToFirstError\n                        preserve={false}\n                    >\n                        {props.subForm[0].component}\n                    </Form>\n                </Modal>\n            )}\n            {props.subForm.length !== 1 && (\n                <StepsForm\n                    current={current}\n                    onCurrentChange={(currentPage: number) => {\n                        setCurrent(currentPage)\n                    }}\n                    formMapRef={formMapRef}\n                    onFinish={async (values) => {\n                        submitData(values)\n                    }}\n                    submitter={{\n                        submitButtonProps: {\n                            loading: submitting\n                        }\n                    }}\n                    stepsFormRender={(dom, submitter) => {\n                        return (\n                            <Modal\n                                destroyOnClose={true}\n                                title={props.title}\n                                className={props.className}\n                                visible={formVis}\n                                maskClosable={false}\n                                width={props.width ?? 1200}\n                                style={{minWidth: props.width}}\n                                onCancel={() => {\n                                    props.onClose && props.onClose()\n                                    setFormVis(false)\n                                }}\n                                footer={submitter}\n                            >\n                                {dom}\n                            </Modal>\n                        );\n                    }}\n                >\n                    {props.subForm.map((item: any, index: number) => {\n                        return (\n                            <StepsForm.StepForm\n                                layout={props.layout ?? \"vertical\"}\n                                name={\"step\" + index}\n                                title={item.label}\n                                onFinish={async () => {\n                                    return true;\n                                }}\n                            >\n                                {item.component}\n                            </StepsForm.StepForm>\n                        )\n                    })}\n                </StepsForm>\n\n            )}\n        </>\n    )\n}\n\nconst mapStateToProps = () => {\n    return {}\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch<any>) => ({\n    addTableVersion: (name: string) => dispatch({type: \"addTableVersion\", name: name}),\n    addManageInitData: (key: string, data: any) => dispatch({type: \"addManageInitData\", key: key, data: data})\n})\n\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(withTranslation()(\n    withRouter(ModalForm)\n))\n"],"sourceRoot":""}