(this.webpackJsonpsduoj=this.webpackJsonpsduoj||[]).push([[22],{1025:function(e,t,a){"use strict";var s=a(957),r=a(958),c=a(292),i=a(1236),n=a(60),l=a(982),j=a(0),o=a(948),d=a(122),b=a(1242),u=a(5);t.a=Object(o.a)()((e=>{const[t,a]=Object(j.useState)(),o=()=>{d.a.getCaptcha().then((t=>{a(t.captcha),e.setImgId(t.captchaId)}))};Object(j.useEffect)((()=>{o()}),[]);const m=Object(u.jsxs)(s.a,{children:[Object(u.jsx)(r.a,{span:14,children:Object(u.jsx)(c.a,{onChange:t=>{void 0!==e.setCaptcha&&e.setCaptcha(t.target.value)}})}),Object(u.jsx)(r.a,{offset:1,span:8,children:Object(u.jsx)(i.a,{src:t,height:32})}),Object(u.jsx)(r.a,{span:1,children:Object(u.jsx)(n.a,{icon:Object(u.jsx)(b.a,{}),onClick:()=>{o()}})})]});return Object(u.jsx)(u.Fragment,{children:[""].map((()=>void 0!==e.setCaptcha?m:Object(u.jsx)(l.a.Item,{name:"captcha",label:e.t("captcha"),rules:[{required:!0}],children:m})))})}))},1026:function(e,t,a){"use strict";var s=a(982),r=a(292),c=a(955),i=a(108),n=a(60),l=a(0),j=a(948),o=a(122),d=a(1025),b=a(5);t.a=Object(j.a)()((e=>{var t;const[a,j]=Object(l.useState)(0),[u,m]=Object(l.useState)(!1),[h,O]=Object(l.useState)(""),[x,p]=Object(l.useState)(""),[g,f]=Object(l.useState)("");return Object(l.useEffect)((()=>{let e=setInterval((()=>{a>0&&j(a-1)}),1e3);return()=>clearInterval(e)})),Object(b.jsxs)(b.Fragment,{children:[!1===e.needVerify&&Object(b.jsx)(s.a.Item,{name:"email",label:e.t("email"),rules:!0!==e.notCheck?[{type:"email",message:e.t("emailError")},{required:!1!==e.editable}]:void 0,hasFeedback:!0,children:Object(b.jsx)(r.a,{disabled:!1===e.editable,bordered:!1!==e.editable})}),!0===e.needVerify&&Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(c.a,{title:"\u4eba\u673a\u8eab\u4efd\u8ba4\u8bc1",visible:u,maskClosable:!1,destroyOnClose:!0,onOk:()=>{o.a.sendVerificationEmail({email:g,captcha:x,captchaId:h,event:e.emailVerifyType}).then((e=>{i.b.success("\u9a8c\u8bc1\u7801\u5df2\u53d1\u9001\u81f3\u60a8\u7684\u90ae\u7bb1"),j(60),m(!1)}))},onCancel:()=>{m(!1)},children:Object(b.jsx)(d.a,{setImgId:O,setCaptcha:p})}),Object(b.jsx)(s.a.Item,{name:"email",label:null!==(t=e.emailTitle)&&void 0!==t?t:e.t("new email"),rules:[{required:!0},t=>{let{getFieldValue:a}=t;return{validator:(t,a)=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)?!1===e.checkExist?Promise.resolve():o.a.isExist({email:a}).then((t=>!1===t?Promise.resolve():!0===t?Promise.reject(e.t("\u90ae\u7bb1\u5df2\u5b58\u5728")):Promise.reject(e.t("\u68c0\u9a8c\u5931\u8d25")))).catch((e=>Promise.reject(e))):Promise.reject(e.t("emailError"))}}],children:Object(b.jsx)(r.a,{disabled:!1===e.editable||a>0,bordered:!1!==e.editable,onPressEnter:e.onPressEnter,addonAfter:Object(b.jsx)(n.a,{type:"text",disabled:0!==a,onClick:()=>{e.getEmail().then((e=>{f(e),m(!0)})).catch((()=>{i.b.error("\u90ae\u7bb1\u4e0d\u5408\u6cd5")}))},children:0!==a?a+"s":e.t("Verify")})})}),Object(b.jsx)(s.a.Item,{name:"emailCode",label:e.t("emailCode"),rules:[{required:!0}],children:Object(b.jsx)(r.a,{onPressEnter:e.onPressEnter})})]})]})}))},1037:function(e,t,a){"use strict";var s=a(982),r=a(292),c=(a(0),a(948)),i=a(122),n=a(5);t.a=Object(c.a)()((e=>Object(n.jsx)(s.a.Item,{name:"username",label:e.t("username"),rules:[{required:!1!==e.editable&&!0!==e.notRequired,message:e.t("usernameEmpty")},t=>{let{getFieldValue:a}=t;return{validator:(t,a)=>!0===e.ExistCheck?i.a.isExist({username:a}).then((e=>!1===e?Promise.resolve():!0===e?Promise.reject("\u7528\u6237\u540d\u5df2\u5b58\u5728"):Promise.reject("\u68c0\u9a8c\u5931\u8d25"))).catch((e=>Promise.reject(e))):Promise.resolve()}}],hasFeedback:!0,children:Object(n.jsx)(r.a,{disabled:!1===e.editable,bordered:e.editable})})))},1051:function(e,t,a){"use strict";function s(e){let t={},a=e.indexOf("?"),s=e.substr(a+1);if(-1!==a){let e=s.split("&");for(let a of e){let e=a.split("=");t[e[0]]=e[1]}}return t}a.d(t,"a",(function(){return s}))},1206:function(e,t,a){"use strict";a.r(t);var s=a(0),r=a(73),c=a(948),i=a(38),n=a(960),l=a(60),j=a(278),o=a(951),d=a(1324),b=a(1320),u=a(1301),m=a(1302),h=a(135),O=a(58),x=a(85),p=a(5);const g=Object(h.a)().FRONT_SERVER;class f extends s.Component{render(){return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)("a",{href:"https://pass.sdu.edu.cn/cas/login?service="+g+x.g+"/thirdPartyLogin?thirdParty=SDUCAS",children:Object(p.jsx)(l.a,{danger:!0,type:"primary",children:this.props.t(Object(O.a)(this.props.title,"SDUAuth"))})})})}}var v=Object(c.a)()(f),y=a.p+"static/media/sduoj.589c3eca.png",P=a(1313),C=a(108),E=a(1025),I=a(1037),F=a(1026),k=a(122);var S=Object(c.a)()((e=>{const[t,a]=Object(s.useState)(),[r,c]=Object(s.useState)("1");return Object(p.jsxs)(P.a,{title:"\u627e\u56de\u5bc6\u7801",trigger:e.button,autoFocusFirstInput:!0,modalProps:{maskClosable:!1,destroyOnClose:!0,width:500,okText:"\u53d1\u9001"},onFinish:async e=>{let a={captchaId:t,captcha:e.captcha};return"1"===r&&(a.username=e.username),"2"===r&&(a.email=e.email),k.a.forgetPassword(a).then((()=>(C.b.success("\u4fee\u6539\u5bc6\u7801\u7684\u94fe\u63a5\u5df2\u53d1\u9001\u81f3\u60a8\u7684\u90ae\u7bb1"),!0)))},children:[Object(p.jsxs)(j.a,{onChange:c,activeKey:r,children:[Object(p.jsx)(j.a.TabPane,{tab:"\u7528\u6237\u540d",children:Object(p.jsx)(I.a,{notRequired:"1"!==r})},"1"),Object(p.jsx)(j.a.TabPane,{tab:"\u90ae\u7bb1",children:Object(p.jsx)(F.a,{needVerify:!1,notCheck:"2"!==r})},"2")]}),Object(p.jsx)(E.a,{setImgId:a})]})}));var V=Object(r.b)((e=>({})),(e=>({})))(Object(c.a)()(Object(i.e)((e=>{const t=Object(s.useRef)(),[a,c]=Object(s.useState)("account"),{t:i}=e,h=Object(r.c)(),O=e=>{h({type:"userLogin"}),h({type:"setUserInfo",data:e})},x=()=>{var e;null===(e=t.current)||void 0===e||e.validateFields(["username","password"]).then((e=>{k.a.login(e).then((e=>{O(e)}))}))},g=()=>{var e;null===(e=t.current)||void 0===e||e.validateFields(["email","emailCode"]).then((e=>{k.a.emailLogin(e).then((e=>{O(e)}))}))};return Object(p.jsx)(n.a,{style:{width:"500px",textAlign:"center",margin:"0 auto"},children:Object(p.jsxs)(d.a,{formRef:t,logo:y,title:i("\u7528\u6237\u767b\u5f55"),subTitle:"",actions:Object(p.jsx)(p.Fragment,{}),submitter:{resetButtonProps:!1,render:(t,s)=>"account"===a||"email"===a?Object(p.jsxs)(l.a,{type:"primary",block:!0,onClick:()=>{"account"===a?x():g()},children:[" ",e.t("Login")," "]}):Object(p.jsx)(v,{})},children:[Object(p.jsx)(j.a,{activeKey:a,onChange:e=>c(e),children:Object(p.jsx)(j.a.TabPane,{tab:i("\u8d26\u53f7\u5bc6\u7801")},"account")}),"account"===a&&Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(b.a,{name:"username",fieldProps:{size:"large",prefix:Object(p.jsx)(u.a,{className:"prefixIcon"}),onPressEnter:()=>x()},placeholder:i("\u8bf7\u8f93\u5165\u7528\u6237\u540d"),rules:[{required:!0,message:i("\u8bf7\u8f93\u5165\u7528\u6237\u540d!")}]}),Object(p.jsx)(b.a.Password,{name:"password",fieldProps:{size:"large",prefix:Object(p.jsx)(m.a,{className:"prefixIcon"}),onPressEnter:()=>x()},placeholder:i("\u8bf7\u8f93\u5165\u5bc6\u7801"),rules:[{required:!0,message:i("\u8bf7\u8f93\u5165\u5bc6\u7801\uff01")}]})]}),"email"===a&&Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(F.a,{emailVerifyType:"login",needVerify:!0,checkExist:!1,emailTitle:i("\u90ae\u7bb1"),onPressEnter:()=>{g()},getEmail:()=>{var e;return null===(e=t.current)||void 0===e?void 0:e.validateFields(["email"]).then((e=>Promise.resolve(e.email))).catch((()=>Promise.reject()))}})}),"SDUCAS"!==a&&Object(p.jsx)("div",{style:{textAlign:"right",marginBottom:10},children:Object(p.jsx)(o.b,{size:3,children:Object(p.jsx)(S,{button:Object(p.jsx)(l.a,{type:"link",size:"small",children:i("\u5fd8\u8bb0\u5bc6\u7801")})})})})]})})})))),T=a(1051),q=a(1006);t.default=Object(c.a)()(Object(i.e)((e=>{const t=Object(r.d)((e=>e.UserReducer.isLogin));return Object(s.useEffect)((()=>{if(!0===t){let t=Object(T.a)(e.location.search).to;void 0===t?e.history.replace(Object(q.a)(q.c)):(e.history.replace(t),C.b.success(e.t("loginSuccessfully")))}}),[t]),Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(V,{})})})))}}]);
//# sourceMappingURL=22.698b0c4a.chunk.js.map