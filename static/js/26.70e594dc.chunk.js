(this.webpackJsonpsduoj=this.webpackJsonpsduoj||[]).push([[26],{1015:function(e,t){},1046:function(e,t,n){"use strict";var s=n(38),o=n(0),r=n(73),i=n(948),a=n(122),c=n(84),l=n(5);t.a=Object(i.a)()(Object(s.e)((e=>{const t=Object(r.c)(),n=Object(r.d)((e=>e.UserReducer.isLogin));return Object(o.useEffect)((()=>{!1===n&&a.a.getProfile().then((e=>{t({type:"setUserInfo",data:e}),t({type:"userLogin"})})).catch((()=>{e.jump&&e.history.replace(c.g+"/login?to="+e.location.pathname)}))}),[n]),Object(l.jsx)(l.Fragment,{})})))},1064:function(e,t,n){"use strict";var s=n(0),o=n(60),r=n(108),i=n(1065),a=n.n(i),c=n(5);class l extends s.Component{constructor(){super(...arguments),this.handleExportAll=(e,t,n)=>{const s=t.map((t=>Object.keys(t).reduce(((n,s)=>(n[e[s]||s]=t[s],n)),{}))),o=a.a.utils.json_to_sheet(s);this.openDownloadDialog(this.sheet2blob(o,void 0),n+".xlsx")},this.handleExportAllJson=(e,t)=>{const n=a.a.utils.json_to_sheet(e);this.openDownloadDialog(this.sheet2blob(n,void 0),t+".xlsx")},this.openDownloadDialog=(e,t)=>{"object"===typeof e&&e instanceof Blob&&(e=URL.createObjectURL(e));var n,s=document.createElement("a");s.href=e,s.download=t||"",window.MouseEvent?n=new MouseEvent("click"):(n=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),s.dispatchEvent(n)},this.sheet2blob=(e,t)=>{let n={SheetNames:[t=t||"sheet1"],Sheets:{}};n.Sheets[t]=e;let s=a.a.write(n,{bookType:"xlsx",bookSST:!1,type:"binary"});return new Blob([function(e){let t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let s=0;s!==e.length;++s)n[s]=255&e.charCodeAt(s);return t}(s)],{type:"application/octet-stream"})}}render(){return Object(c.jsx)(o.a,{type:this.props.ButtonType,...this.props.ButtonProps,onClick:()=>{if(void 0!==this.props.getJson)this.props.getJson().then((e=>{this.handleExportAllJson(e,this.props.fileName)})).catch((e=>{r.b.error(e)}));else{const e=this.props.nowData(),t=this.props.colMap(e);this.handleExportAll(t,e,this.props.fileName)}},children:this.props.ButtonText})}}t.a=l},1070:function(e,t){},1071:function(e,t){},1079:function(e,t,n){"use strict";var s=n(1063),o=n.n(s),r=n(58),i=n(134);const a=Object(i.a)().FRONT_SERVER;var c=n(0),l=n(5);t.a=e=>{const[t,n]=Object(c.useState)(!1),[s,i]=Object(c.useState)(!1);return Object(c.useEffect)((()=>{Object(r.c)(e.text)||t||s===e.text||(n(!0),i(e.text),function(e,t){var n,s,i;(Object(r.c)(e)||Object(r.c)(null===(n=e)||void 0===n?void 0:n.trim()))&&(e=""),e=null===(i=e=null===(s=e)||void 0===s?void 0:s.replaceAll(/`{3}\n([-|0-9a-zA-Z])/g,"```plaintext\n$1"))||void 0===i?void 0:i.replaceAll(/\$\n(.*)\n\$/g,"$ $1 $");const c={mode:"light",cdn:a+"/vditor",emojiPath:a+"/vditor/dist/images/emoji",theme:{path:a+"/vditor/dist/css/content-theme"},hljs:{lineNumber:!1},markdown:{toc:!0,mark:!0,footnotes:!0,autoSpace:!0},math:{inlineDigit:!0,engine:"KaTeX"}};return o.a.preview(document.getElementById(t),e,c)}(e.text,e.id).then((e=>{n(!1)})))}),[e.id,e.text,t]),Object(l.jsx)("div",{id:e.id,style:{overflowY:"hidden"}})}},1182:function(e,t,n){"use strict";var s=n(73),o=n(122),r=n(0);t.a=(e,t)=>{const n=Object(s.d)((t=>t.ContestReducer.contestInfo[e])),i=Object(s.c)(),[a,c]=Object(r.useState)(!1);return Object(r.useEffect)((()=>{!1===t||a||void 0!==n&&!0!==t||(c(!0),o.a.getContestInfo({contestId:e}).then((t=>{i({type:"setContestInfo",key:e,data:t})})).catch((()=>{setTimeout((()=>{c(!1)}),3e3)})))}),[n,t]),!1===t?void 0:n}},1236:function(e,t,n){"use strict";n.r(t);var s=n(948),o=n(38),r=n(961),i=n(960),a=n(1354),c=n(957),l=n(958),d=n(951),j=n(200),b=n(1109),p=n(1038),m=n(0),h=n(1182),u=n(240),O=n(1261),x=n.n(O),g=n(1361),f=n(954),v=n(1335),y=n(73),S=n(58),k=n(5);var w=e=>{const[t,n]=Object(m.useState)(Date.now());return Object(m.useEffect)((()=>{let e=setInterval((()=>{n(Date.now())}),1e3);return()=>clearInterval(e)})),Object(k.jsxs)(k.Fragment,{children:["before"===e.type&&Object(u.a)(e.time,t),"after"===e.type&&Object(u.a)(t,e.time)]})},C=n(178),E=n(84),I=n(1064);var T=n(1079);var M=Object(y.b)((e=>{var t,n;const s=e.UserReducer,o=e.ContestReducer;return{username:null===(t=s.userInfo)||void 0===t?void 0:t.username,roles:null===(n=s.userInfo)||void 0===n?void 0:n.roles,afterContestSubmission:o.afterContestSubmission,allowSliderMove:o.allowSliderMove,sliderTime:o.sliderTime,openSliderMove:o.openSliderMove,exportData:o.exportData}}),(e=>({setAfterContestSubmission:t=>e({type:"setAfterContestSubmission",data:t}),setSliderTime:t=>e({type:"setSliderTime",data:t}),setOpenSliderMove:t=>e({type:"setOpenSliderMove",data:t})})))(Object(s.a)()(Object(o.e)((e=>{const[t,n]=Object(m.useState)(""),s=e.match.params.contestId,o=e.location.pathname,O=Object(h.a)(s),[y,M]=Object(m.useState)(Date.now()),R=[{name:"Register",link:E.g+"/contest/"+s+"/register",re:/\/contest\/.*\/register/g},{name:"Overview",link:E.g+"/contest/"+s+"/overview",re:/\/contest\/.*\/overview/g},{name:"Problem",link:E.g+"/contest/"+s+"/problem/1",re:/\/contest\/.*\/problem\/.*/g},{name:"Status",link:E.g+"/contest/"+s+"/submission",re:/\/contest\/.*\/submission/g},{name:"Rank",link:E.g+"/contest/"+s+"/rank",re:/\/contest\/.*\/rank/g}],D=void 0!==O?Object(u.b)(O.gmtStart,O.gmtEnd):void 0,A=void 0!==O?-1!==O.participants.indexOf(e.username):void 0,N=void 0!==O?O.features.openness:void 0;return Object(m.useEffect)((()=>{null!==o.match(/\/contest\/[0-9]*\/?$/g)&&void 0!==N&&void 0!==A&&("private"!==N||A?e.history.replace(R[1].link):e.history.replace(R[0].link)),null!==o.match(R[0].re)&&A&&e.history.replace(R[1].link),R.map((e=>{null!==o.match(e.re)&&n(e.name)}))}),[o,N,A]),Object(m.useEffect)((()=>{Math.abs(y-e.sliderTime)>=6e4&&e.setSliderTime(y)}),[y,e.sliderTime]),Object(k.jsxs)(k.Fragment,{children:[void 0!==O&&Object(k.jsxs)(k.Fragment,{children:[!Object(S.c)(O.markdownDescription)&&!Object(S.c)(O.markdownDescription.trim())&&Object(k.jsx)(r.a,{message:Object(k.jsx)(T.a,{id:"contest-markdownDescription",text:null===O||void 0===O?void 0:O.markdownDescription}),type:"info"}),Object(k.jsxs)(i.a,{style:{marginTop:25},children:[Object(k.jsxs)("div",{className:"center",children:[Object(k.jsxs)("span",{style:{float:"left"},children:[Object(k.jsx)("span",{style:{fontWeight:"bold"},children:"\u5f00\u59cb\u65f6\u95f4\uff1a"}),Object(u.d)(O.gmtStart)]}),Object(k.jsxs)("span",{style:{fontWeight:"bold",fontSize:"1.75rem"},children:[Object(k.jsx)("span",{style:{paddingRight:10},children:O.contestTitle}),"private"===O.features.openness&&Object(k.jsx)(g.a,{style:{color:"red"}}),"protected"===O.features.openness&&Object(k.jsx)(g.a,{style:{color:"orange"}})]}),Object(k.jsxs)("span",{style:{float:"right"},children:[Object(k.jsx)("span",{style:{fontWeight:"bold"},children:"\u7ed3\u675f\u65f6\u95f4\uff1a"}),Object(u.d)(O.gmtEnd)]})]}),"wait"!==D&&Object(k.jsx)(a.a,{style:{marginTop:25},tipFormatter:null,min:parseInt(O.gmtStart),max:parseInt(O.gmtEnd),value:e.openSliderMove?y:Math.max(Math.min(Date.now(),parseInt(O.gmtEnd)),parseInt(O.gmtStart)),onChange:e.openSliderMove?M:void 0}),Object(k.jsx)("div",{style:{marginTop:15},className:"center",children:Object(k.jsxs)(c.a,{children:[Object(k.jsx)(l.a,{span:8,children:"running"===D&&Object(k.jsxs)("span",{style:{float:"left"},children:[Object(k.jsx)("span",{style:{fontWeight:"bold"},children:"\u5df2\u7528\u65f6\u95f4\uff1a"}),Object(k.jsx)(w,{type:"before",time:O.gmtStart})]})}),Object(k.jsxs)(l.a,{span:8,children:["wait"===D&&Object(k.jsx)("span",{style:{color:"blue"},children:Object(k.jsxs)(d.b,{children:["\u8ddd\u79bb\u5f00\u59cb\u8fd8\u6709\uff1a",Object(k.jsx)(x.a,{className:"contestHeaderTimer",value:parseInt(O.gmtStart),format:"H \u65f6 m \u5206 s \u79d2"})]})}),"running"===D&&Object(k.jsx)("span",{style:{color:"red"},children:"\u8fdb\u884c\u4e2d"}),"end"===D&&Object(k.jsx)("span",{style:{color:"green"},children:"\u5df2\u7ed3\u675f"})]}),Object(k.jsx)(l.a,{span:8,children:"running"===D&&Object(k.jsxs)("span",{style:{float:"right"},children:[Object(k.jsx)("span",{style:{fontWeight:"bold"},children:"\u5269\u4f59\u65f6\u95f4\uff1a"}),Object(k.jsx)(w,{type:"after",time:O.gmtEnd})]})})]})})]})]}),Object(k.jsxs)(c.a,{style:{backgroundColor:"white",border:"1px solid #dcdee2"},children:[Object(k.jsx)(l.a,{span:10,children:Object(k.jsx)(j.a,{mode:"horizontal",theme:"light",style:{border:0},selectedKeys:[t],children:R.map((t=>{if(("wait"!==D||"Register"===t.name)&&(!A||"Register"!==t.name)&&("private"!==N||!1!==A||"Register"===t.name))return Object(k.jsx)(j.a.Item,{onClick:()=>{n(t.name),e.history.push(t.link)},children:e.t(t.name)},t.name)}))})}),Object(k.jsx)(l.a,{span:14,children:void 0!==O&&Object(k.jsxs)(d.b,{size:10,style:{marginTop:"12px",marginRight:"30px",marginBottom:"12px",float:"right",color:"grey"},children:[e.openSliderMove&&Object(k.jsxs)(k.Fragment,{children:[Object(u.a)(O.gmtStart,y),Object(k.jsx)(b.a,{type:"vertical"})]}),!0===e.allowSliderMove&&"Rank"===t&&Object(k.jsxs)(k.Fragment,{children:["\u5386\u53f2\u56de\u653e",Object(k.jsx)(p.a,{checked:e.openSliderMove,onChange:e.setOpenSliderMove,checkedChildren:"\u542f\u7528",unCheckedChildren:"\u5173\u95ed"}),Object(k.jsx)(b.a,{type:"vertical"})]}),Object(C.a)(e.roles,["admin","superadmin"])&&"end"===D&&"Rank"===t&&Object(k.jsxs)(k.Fragment,{children:["\u8d5b\u540e\u63d0\u4ea4",Object(k.jsx)(p.a,{checked:e.afterContestSubmission,onChange:e.setAfterContestSubmission,checkedChildren:"\u663e\u793a",unCheckedChildren:"\u4e0d\u663e\u793a"}),Object(k.jsx)(b.a,{type:"vertical"})]}),Object(C.a)(e.roles,["admin","superadmin"])&&"Rank"===t&&Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(I.a,{ButtonProps:{size:"small"},ButtonText:"\u5bfc\u51fa",ButtonType:"link",getJson:()=>async function(e){let t=[];for(const n of e)if(!0===n.official){let e={"\u6392\u540d":n.rank,"\u59d3\u540d":n.nickname,"\u5b66\u53f7":n.username,"\u603b\u5206":n.sumScore,"\u8fc7\u9898\u6570":n.ACNumber,"\u7f5a\u65f6":n.penalty};for(const t in n.Cell)e["\u9898\u76ee"+t+"-\u5206\u6570"]=n.Cell[t].score,e["\u9898\u76ee"+t+"-\u63d0\u4ea4\u6b21\u6570"]=n.Cell[t].tries,e["\u9898\u76ee"+t+"-\u901a\u8fc7\u60c5\u51b5"]=n.Cell[t].className;t.push(e)}return Promise.resolve(t)}(e.exportData),fileName:O.contestTitle+"_"+Date.now()+"_\u7ed3\u679c\u5bfc\u51fa"}),Object(k.jsx)(b.a,{type:"vertical"})]}),"acm"===O.features.mode&&Object(k.jsx)("span",{style:{backgroundColor:"#3676b6",color:"#fff",padding:"0 10px",borderRadius:".75rem"},children:"ACM"}),"ioi"===O.features.mode&&Object(k.jsx)("span",{style:{backgroundColor:"#ea517f",color:"#fff",padding:"0 10px",borderRadius:".75rem"},children:"IOI"}),"oi"===O.features.mode&&Object(k.jsx)("span",{style:{backgroundColor:"#f8df72",color:"#fff",padding:"0 10px",borderRadius:".75rem"},children:"OI"}),Object(k.jsx)(b.a,{type:"vertical"}),Object(k.jsxs)("span",{children:[Object(k.jsx)(f.a,{})," ",Object(u.a)(O.gmtStart,O.gmtEnd)]}),Object(k.jsx)(b.a,{type:"vertical"}),Object(k.jsxs)("span",{children:[Object(k.jsx)(v.a,{})," ",O.participantNum]})]})})]})]})})))),R=n(1003),D=n(303),A=n(1046);t.default=Object(y.b)((e=>{const t=e.ContestReducer;return{ContestInfo:t.contestInfo,minWidth:t.minWidth}}),(e=>({})))(Object(s.a)()(Object(o.e)((e=>{var t;const n=e.match.params.contestId,s=e.ContestInfo[n],r=void 0!==s?Object(u.b)(s.gmtStart,s.gmtEnd):void 0;let i=500;const[a,c]=Object(m.useState)(null===(t=document.querySelector("body"))||void 0===t?void 0:t.clientWidth);Object(m.useEffect)((()=>(window.addEventListener("resize",l),()=>{window.removeEventListener("resize",l)})));const l=e=>{c(e.target.innerWidth)};var d;null!==e.location.pathname.match(/\/contest\/.*\/rank/g)&&(i=Math.max(500,(null!==(d=e.minWidth)&&void 0!==d?d:0)+100));return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(A.a,{jump:!0}),Object(k.jsx)("div",{style:i<=1500?{textAlign:"center",margin:"0 auto"}:void 0,children:Object(k.jsxs)("div",{style:i<=1500?{textAlign:"left",maxWidth:"1500px",margin:"0 auto"}:{textAlign:"left",maxWidth:"1500px",marginLeft:Math.max(0,(a-i)/2)},children:[Object(k.jsx)(M,{}),void 0!==s&&"wait"!==r&&Object(k.jsx)("div",{style:{marginTop:25},children:Object(k.jsx)(m.Suspense,{fallback:Object(k.jsx)(D.a,{}),children:R.c.map((e=>Object(k.jsx)(o.a,{path:e.path,exact:e.exact,component:e.component},e.id)))})})]})})]})}))))}}]);
//# sourceMappingURL=26.70e594dc.chunk.js.map